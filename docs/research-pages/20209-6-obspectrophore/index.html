<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.65">
<script src="https://use.fontawesome.com/releases/v5.14.0/js/all.js"></script>
<script src="/page.js"></script>
<script src="https://www.molsoft.com/lib/moledit.js"></script><title data-react-helmet="true">Fall20-W6 Spectrophores (TM) | Yumechi - VDS Pages</title><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Fall20-W6 Spectrophores (TM) | Yumechi - VDS Pages"><meta data-react-helmet="true" name="description" content="Objective"><meta data-react-helmet="true" property="og:description" content="Objective"><meta data-react-helmet="true" property="og:url" content="https://vds.yumechi.top/docs/research-pages/20209-6-obspectrophore"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://vds.yumechi.top/docs/research-pages/20209-6-obspectrophore"><link rel="stylesheet" href="/styles.6c52e890.css">
<link rel="preload" href="/styles.732d6b54.js" as="script">
<link rel="preload" href="/runtime~main.eebfad77.js" as="script">
<link rel="preload" href="/main.866d608d.js" as="script">
<link rel="preload" href="/1.4f3ddc9d.js" as="script">
<link rel="preload" href="/2.818d213b.js" as="script">
<link rel="preload" href="/41.54f1d121.js" as="script">
<link rel="preload" href="/42.e9a910b0.js" as="script">
<link rel="preload" href="/935f2afb.f00d23fd.js" as="script">
<link rel="preload" href="/17896441.37a0ac9c.js" as="script">
<link rel="preload" href="/0324bf9b.aea4f043.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="My Site Logo"><strong class="navbar__title">Yumechi</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Documents</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/eternal-flame-AD/vds-yumechi-top" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.svg" alt="My Site Logo"><strong class="navbar__title">Yumechi</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Documents</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/eternal-flame-AD/vds-yumechi-top" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/">Welcome</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Research Pages</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/research-pages/">Research Pages Index</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/research-pages/20209-2-vpipe-pcr">Fall20-W2 V-PIPE PCR</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/research-pages/20209-3-vs-phosphatase">Fall20-W3 VS Phosphatase</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/research-pages/20209-3-oligo-optimize">Fall20-W3 Oligo and gBlocks Design</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/research-pages/20209-4-ipipe-primer">Fall20-W4 I-PIPE Primer Design</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/research-pages/20209-5-miniprep">Fall20-W5 Miniprep</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/research-pages/20209-6-vs-chbre">Fall20-W6 Target Virtual Screening - Chembridge Economy</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/research-pages/20209-6-obspectrophore">Fall20-W6 Spectrophores (TM)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/research-pages/20209-7-vs-chbre-vina">Fall20-W7 Target Virtual Screening - Chembridge Economy (VINA)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/research-pages/20209-8-vs-ipipe-pcr">Fall20-W8 IPIPE PCR</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Lab Notes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/lab-notes/">Lab Notes Index</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Virtual Lab</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">PyMOL</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/lab-notes/virtual/pymol/pymolrc">My .pymolrc file</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">CSD-GOLD</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/lab-notes/virtual/gold/convenient-scripts">GOLD Convenient Scripts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/lab-notes/virtual/gold/conformer-generation">Conformer Generation</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Rosetta</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/lab-notes/virtual/rosetta/mutate-single-residue">Mutate single residue with rosetta</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/lab-notes/virtual/rosetta/thread-then-hybridize">Thread and hybridize model from homologys</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Wet Lab Procedures</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">PCR</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/lab-notes/wetlab/pcr/primer-dilution">Primer Dilution</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/lab-notes/wetlab/pcr/pipe-cloning">PIPE Cloning PCR</a></li></ul></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Style Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/style-guides/index">Style Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/style-guides/mdx">Powered by MDX</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><div><span class="badge badge--secondary">Version: Next</span></div><header><h1 class="docTitle_1Lrw">Fall20-W6 Spectrophores (TM)</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="objective"></a>Objective<a aria-hidden="true" tabindex="-1" class="hash-link" href="#objective" title="Direct link to heading">#</a></h2><p>When docking extra-large libraries, there may be a lot of occurences of similar molecules within the library.</p><p>Thus, it may be beneficial to first cluster the library and do a preliminary scan by docking samples from each cluster to predict
the overall competence of each cluster to the receptor without having to dock every single ligand in the library. Then, clusters
with poor performances can be excluded from the dock while good libraries will be docked in full in order to find the best-performing molecule
in the cluster.</p><p>Generally speaking, when the library is very large compared to the available computational resource,
we are not expecting to put every molecule through the screening stage. Thus, there will be a problem of
which molecule to dock and which to skip. For this problem there are several solutions that I want to discuss:</p><ol start="0"><li>The most obvious is a naive random selection - say we only dock 50% of the library by random choice. In theory we would also
only get 50% of the hits as result.</li></ol><p>To get more than 50% of the hits with only 50% of the CPU time, there are several heuristic methods available:</p><ol><li><p>Only dock molecules with matching pharmacophore features.
This is a very good method to use and I have seen many papers using this method. Generally the idea is to use researcher&#x27;s input
to filter out clearly unsuitable ligands.
The general idea of this approach is that: in the end the good matches will have most of the desired pharmacophore points
that the receptor wants, thus we can first exclude molecules that simply can&#x27;t satisfy these constraints geometrically.
This approach is good in that it is very fast and very accurate as long as the prediction is good. However, when
a clear pharmacophore point in the receptor can not be determined confidently (complex receptor, multiple binding modes, etc),
this method can be hard to implement.</p></li><li><p>A &quot;quick&quot; dock followed by a &quot;slow&quot; dock for top hits.
Generally speaking, I don&#x27;t see this method as significantly better than naive random selection. The main problem is,
docking program score poses strictly on molecular mechanics (or similar ways). Thus, the scoring function is usually very strict (in a sense of 1 to 2 angstroms)
in that a small deviation from the &quot;ideal&quot; pose may lead to a significant score loss (may not be better than random at all).
(Well to verify this, we can write a program that does some small transformation on the ligand and send the new pose to GOLD
score function and see how much the score has changed.) Another problem is a &quot;quick&quot; dock does not come for free either. A simple math: let&#x27;s say the &quot;quick&quot; dock takes 20% of the CPU time than the &quot;slow&quot; dock.
(pretty generous, normally you wouldn&#x27;t expect this much a speed boost)
That means, if our CPU time budget is enough for docking 50% percent of ligands in &quot;slow&quot; mode, after the &quot;quick&quot; dock we can only do 30% of the ligands. In other words,
in order to &quot;earn back&quot; the CPU time we lost for the preliminary dock, it at least need to provide almost twice the selectivity compared to random to merely
come in equal with the naive solution.</p></li></ol><p>To give some numbers to back my hypothesis:</p><p>GOLD is not open-source so I can&#x27;t say much about GOLD, but for VINA, the energy well for VINA is (from VINA paper):
(1) 1.0 A for hydrophobic terms
(2) 0.7 A for H bonds
If the monte-carlo search can&#x27;t hit inside this well,
it won&#x27;t be accepted as a possible pose, thus, we will miss the pose and, unless their is another good binding pose enough to let
this molecule stand out, this molecule will be excluded from the search.So I dug into the source of VINA and looked at their implementation of &quot;exhaustiveness&quot;, basically it simply indicates how many repeats should
the monte carlo search be done. Every time the search tries to shift the molecule by 2 A (from VINA source code). So a rough estimate for the
sampling accuracy for the default exhaustiveness 8 would be 0.5 A. Halfing this value would be have the CPU time but half the probability of discovering a pose (since the step would be larger
than the energy well). Which defeats the purpose of a heuristic screening.</p><p>My proposal is to make the scale of the ligands smaller by clustering them into bins and only sample results from the bins.
The general idea is, molecules with similar 3D characteristics should behave similarly in screening. Thus, by taking samples from
a cluster of closely-related molecules, we can predict the approximate performance of this group of molecules has we docked all of them.
In this way, we can exclude groups of molecules that are unlikely to success (multiple samples from the bin behaved poorly).</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="methods-work-in-progress"></a>Methods (Work In Progress)<a aria-hidden="true" tabindex="-1" class="hash-link" href="#methods-work-in-progress" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="preparation-for-library-once-per-library"></a>Preparation for library (once per library)<a aria-hidden="true" tabindex="-1" class="hash-link" href="#preparation-for-library-once-per-library" title="Direct link to heading">#</a></h3><ol><li><p>Generate spectrophore(TM) information of each molecule with <a href="https://openbabel.org/docs/dev/Fingerprints/spectrophore.html" target="_blank" rel="noopener noreferrer">OpenBabel - obspectrophore application</a>.</p><p>This should be a relatively quick process (&lt;30 mins on a single KNL node for my 13 million ZINC library).</p><p>It will reduce the whole 3-D structure into a 48-dimension vector by considering molecular features such as shape,
lipophilicity, electrophilicity, etc. (see obspectrophore page for details)
These properties that are just happens to be important variables to consider in virtual screening, namely:</p><ul><li>Shape of molecule</li><li>Magnitude and positioning of features</li><li>Surface area</li></ul><p>Thus, I predict that molecules that produce similar results in obspectrophore should get similar results in virtual screening.</p></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="clustering"></a>Clustering<a aria-hidden="true" tabindex="-1" class="hash-link" href="#clustering" title="Direct link to heading">#</a></h3><ol start="2"><li><p>Train a K-Means model to sort the ligands into clusters besed on obtained spectrophore vectors.</p><p>For this part I custom-coded a K-means implementation to run fast enough on KNL by utilizing AVX512 instructions.
Algorithm Reference: <a href="http://cs229.stanford.edu/notes/cs229-notes7a.pdf" target="_blank" rel="noopener noreferrer">http://cs229.stanford.edu/notes/cs229-notes7a.pdf</a></p><p>This is a relatively easy-to-implement and robust clustering algorithm in ML.</p><p>For my 13 million library, I set the algorithm to make 50k bins, the algorithm converged after 50 cycles (~80hrs of total
computation on a single KNL node).</p><p>The model reusable in theory as long as the number of bins stays the same, have not tested this in the context of molecular clustering.</p></li><li><p>Evaluate the model on all ligands.</p><p>This is (almost) equiv to a cycle of training in terms of computational complexity. (Thus, &lt;2h for my 13m library on a single KNL node)</p></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="evaluation"></a>Evaluation<a aria-hidden="true" tabindex="-1" class="hash-link" href="#evaluation" title="Direct link to heading">#</a></h3><ol start="4"><li><p>Scan through the library with desired virtual screening method by taking (k) samples randomly from each of the cluster.</p></li><li><p>Exclude clusters that does not perform well. Multiple methods, simpliest one would be to just take the average of each cluster samples
and exclude low scores. Alternatively, if the correlation is really strong, an statistical inference can be done to confidently say some cluster
are unlikely to &quot;success&quot; just based on the sample.</p></li><li><p>Dock every single molecule in the selected clusters to find best candidate(s).</p></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="discussion"></a>Discussion<a aria-hidden="true" tabindex="-1" class="hash-link" href="#discussion" title="Direct link to heading">#</a></h2><p>I am planning on carrying out an evaluation on this. I have done some preliminary non-direct ways and sort of saw some good indicators. The next steps to verify these methods are:</p><p>(1) Statistically speaking, how much inference can we make on these clusters just based on limited sampling? (a.k.a. how much deviation in score within a cluster) comparatively easy to verify
(2) A controlled docking. Basically: take some known inhibitors that the docking software can perform well on. Mix them into the bins. Run it through the algorithm. Calculate  (Selectivity %) / (CPU Time %) = f(p%) = (% of ligands in first p% bins) / (p%).
I expect a ratio of at least 3 (3 times more controls selected than random) in a consider portion of 0% &lt; p% &lt; 50% to say using this method is worth the effort.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/eternal-flame-AD/vds-yumechi-top/edit/master/docs/research-pages/20209-week6-obspectrophore.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/research-pages/20209-6-vs-chbre"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Fall20-W6 Target Virtual Screening - Chembridge Economy</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/research-pages/20209-7-vs-chbre-vina"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Fall20-W7 Target Virtual Screening - Chembridge Economy (VINA) Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#objective" class="table-of-contents__link">Objective</a></li><li><a href="#methods-work-in-progress" class="table-of-contents__link">Methods (Work In Progress)</a><ul><li><a href="#preparation-for-library-once-per-library" class="table-of-contents__link">Preparation for library (once per library)</a></li><li><a href="#clustering" class="table-of-contents__link">Clustering</a></li><li><a href="#evaluation" class="table-of-contents__link">Evaluation</a></li></ul></li><li><a href="#discussion" class="table-of-contents__link">Discussion</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Quick Links</h4><ul class="footer__items"><li class="footer__item"><a href="https://utexas.app.box.com/folder/121369283675" target="_blank" rel="noopener noreferrer" class="footer__link-item">Yumechi&#x27;s UTBox Folder</a></li><li class="footer__item"><a href="https://sites.google.com/site/vdsstream/" target="_blank" rel="noopener noreferrer" class="footer__link-item">VDS Stream Google Site</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/eternal-flame-AD" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="text--center"><div>Copyright Â© 2020 Yumechi & VDS Stream. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.732d6b54.js"></script>
<script src="/runtime~main.eebfad77.js"></script>
<script src="/main.866d608d.js"></script>
<script src="/1.4f3ddc9d.js"></script>
<script src="/2.818d213b.js"></script>
<script src="/41.54f1d121.js"></script>
<script src="/42.e9a910b0.js"></script>
<script src="/935f2afb.f00d23fd.js"></script>
<script src="/17896441.37a0ac9c.js"></script>
<script src="/0324bf9b.aea4f043.js"></script>
</body>
</html>